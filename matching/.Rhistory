xy <- readr::read_lines('https://gist.githubusercontent.com/sw1/8870a124624f31585d5c15be72fcfc21/raw/6617b2ceae8765ff7b91f4a600fc5460b335279d/lcs_sequences')
xy <- readr::read_lines('https://gist.githubusercontent.com/sw1/8870a124624f31585d5c15be72fcfc21/raw/6617b2ceae8765ff7b91f4a600fc5460b335279d/lcs_sequences')
module load R
xy <- readr::read_lines('https://gist.githubusercontent.com/sw1/8870a124624f31585d5c15be72fcfc21/raw/6617b2ceae8765ff7b91f4a600fc5460b335279d/lcs_sequences')
install.packages(c("Rcpp","readr"))
xy <- readr::read_lines('https://gist.githubusercontent.com/sw1/8870a124624f31585d5c15be72fcfc21/raw/6617b2ceae8765ff7b91f4a600fc5460b335279d/lcs_sequences')
find_lcs(xy[1],xy[2])$lcs
source('lcr.R')
q()
source('lcs.R')
find_lcs(xy[1],xy[2])$lcs
pam250 <- as.matrix(read.table('https://gist.githubusercontent.com/sw1/8870a124624f31585d5c15be72fcfc21/raw/0b783786e3797d1bb55172e750776e26021224b0/PAM250.dat'))
xy <- readr::read_lines('https://gist.githubusercontent.com/sw1/8870a124624f31585d5c15be72fcfc21/raw/6617b2ceae8765ff7b91f4a600fc5460b335279d/local_sequences')
source('global.R')
global_alignment(xy[1],xy[2],5,pam250)$global
global_alignment(xy[1],xy[2],5,pam250)$global
global_alignment(xy[1],xy[2],5,pam250)$global
global_alignment(xy[1],xy[2],5,pam250)$global
penalty
penalty
source('global.R')
global_alignment(xy[1],xy[2],5,pam250)$global
global_alignment(xy[1],xy[2],-5,pam250)$global
q()
global_alignment(xy[1],xy[2],-5,pam250)$global
global_alignment(xy[1],xy[2],-5,pam250)$global
global_alignment(xy[1],xy[2],-5,pam250)$global_alignment
local_alignment(xy[1],xy[2],-5,pam250)$global
local_alignment(xy[1],xy[2],-5,pam250)$global
source('global.R')
source('global.R')
local_alignment(xy[1],xy[2],-5,pam250)$global
source('global.R')
local_alignment(xy[1],xy[2],-5,pam250)$global
q()
x < xy[1]
x <- xy[1]
y <- xy[2]
score_matrix <- pam250
penalty <- -5
local_alignment(x,y,score_matrix,penalty)
source('global.R')
local_alignment(x,y,score_matrix,penalty)
source('global.R')
local_alignment(x,y,score_matrix,penalty)
source('global.R')
local_alignment(x,y,score_matrix,penalty)
source('global.R')
local_alignment(x,y,score_matrix,penalty)
source('global.R')
local_alignment(x,y,score_matrix,penalty)
source('global.R')
local_alignment(x,y,score_matrix,penalty)
source('global.R')
local_alignment(x,y,score_matrix,penalty)
source('global.R')
q()
local_alignment(x,y,score_matrix,penalty)
source('global.R')
'''
for (i in seq(2,m+1)){
for (j in seq(2,n+1)){
      
s_up <- s[i-1,j] + penalty
s_left <- s[i,j-1] + penalty
s_diag <- s[i-1,j-1] + score_matrix[x[i-1],y[j-1]]
    
    scores <- c(s_up,s_left,s_diag,0)  # and 0
    
# get the position of the max score
    backtrack_update <- which.max(scores)
# update the scores
    score_matrix_update <- max(scores)
if (score_matrix_update < 0){
score_matrix_update <- 0
}
s[i,j] <- score_matrix_update
b[i,j] <- backtrack_key[backtrack_update]
    
  }
}
'''
pam250 <- as.matrix(read.table('https://gist.githubusercontent.com/sw1/8870a124624f31585d5c15be72fcfc21/raw/0b783786e3797d1bb55172e750776e26021224b0/PAM250.dat'))
xy <- readr::read_lines('https://gist.githubusercontent.com/sw1/8870a124624f31585d5c15be72fcfc21/raw/6617b2ceae8765ff7b91f4a600fc5460b335279d/local_sequences')
local_alignment(x,y,score_matrix,penalty)
$alignment
[1] "RWTCYKTQSQQLEDCALHFMSFRDL-MSTQTCANTESTAMF--CNER-FMADVPFKDERHQH-LSNNACMWTSD-EINGVRDID-HNPNSTR-MNQAF-F-HNCYSRAD-RPNNPFLFTQMCQCTNPFVLKKYCQYVIGESRMMFTM-TMDEEWLIAYCQFRGWSADLFHP--CV-QEGSDG-VIWMDHAQKHYI-LNGVPKGFH-VDWMIMTPDFMVNSCCELPAAEQGSKGHKQWFNLDFFCTDFLAYA-LV-LDQ-CTHSRK--GLIFYGAT-TFKPIIMMVNNHYSCKWCRYVWHYMSRKSYHLVINHPKSIYLSIPLNHHQFNGGQIYTKYPVVPEHTKILTQYLRVKRGQCKPRHHT-WHVTFQEGWGHDHDYKGCDDCNEFDNWQIHLQKTSSVAEDPIRWTDTAHCT-QGSSWH-PRSTNQFLKDGYTFWDIFITMTAGLDSV-WQAYGCDPYSLDRVPHPNNDTDHYTCMDRMPH---KRYI-ATQVFSNLGWHME-QLQKSISFMD-WGYVFDRY-ISVDCLTAFWGCPPM-NTGNPIEPRNFIRAVFYKQVDCH--CDNPFSAEWCPHSCLTILRGFWVAELSQWLWYTNKGNVHYNVDADQEKW-KG-DGHHFRSLVQLLQM-MG-V--HTSS-GE-Y-VP-L-CSGVHYTINDDLQWVDC-VQY-VEWFAVTMDNTQF-D-LSEHE--FDYTEES-M-C-MTTYR--G-GM-E---QRQVQSPTNQDSHFKR--EE---FIRADIANEKCHR-QGMYTI-QAGGCFID-YATFDR--M--L-P-DGFP-W-A-RMFQGAC-LYYMNQLECR-LC-MSNAVVYQGF-NLK-KTNRDCCNSAWLWNLWFVRCKYTCVDTAKNQACRYSR-TW-PSRSA-NPPMLK-CFLWI-KICKYMTDLEA-FEQST-GGEYGQKVVCCGCDAIYSKQFKIRPK-HFM-MITWPNFNV-S---F-RK--GYH-S-QVQLFPNKDGDFYDQYR-CEDLMNRRRTWGGDFSSGPCVLLNGWVFMCKK-L-WAQMNAHW-QYKQCFAMKAL-S--PWQT---W-E-EQ-FAHESCCACYAR---FYTMIIIHG----D-IKLNPK-DHPAYVEVIYRCHTG--CSPDHQVFKAYVHQ-VS-P--KGMPNNQYDDCPTYAMWYPTDEIEQNDPQNLAWILAYFCKFCLDRLP-----CYVSAAMWSEYNLT-YK-G-NGL--Y----N----ENDWSPTRI--MEGRATK-FYCTWKKSGNSLQTSE----H--IKSIEFYFRLIYIRKKWTQLVPW-EYLCGRLHLQAFQYKFFKQVWHITVFEENP--R-------RD--VRQFMHHTMGT--C---SM----TFMNSKYGMKFCAM--------FP-KSKRRLMDKHVKYG-MTLQKMEFAFKGQFCIM-T----FEGEAGCRY--IQWSQYG---E-W----KCDCFGIDYSAMYHVADSHPNSLTIFSYAVFQNMGPDDYSPRVCT--DIMMPMVVFEIGGKMNRGGAAMTDIIVTQEHEYYTICIQDPKYKGYYVDNQWQVNGIIPGAPAQIWVW--L-SQCCADDSDEQKLAFMMTKDD--E---P-MS-RM--HCDYLYHGKVEHIVSDQCPTTFMVDQCQFLQW-CPRRWEPRCPNLKNYLHQCGSTQMSWWMWWILYH----------D--CLVDETKCKKCFLNSVP--WRHTWDSDPRHVTNYHSMNRCFQTVDCLLHPFIAYDGLVIIACQEIWGWIMK--YVKEVGDAHKCLSV-YE-F-EQI----SMLMRWVSW---PIHPWKGMGGFANYCCCACGILGFEKDLMGRKPSELFKHV-Y--CHERIWHNYNTFEDMSAEEWTMQYGNPFFWKFATSGTKEWAHARMWPRRNCDVES-T--WMPMGAE-WAHSSQKQF--S--SSGKPQWAWSVKQNIEGAPNNCKWYKPPTHFFGYADVWFQLNWMRYDMCE-Y---SDHVHDTYEHMNFYQRCPKAHG--FKTYDQSRQRTVLDCYSAWGVESFTETQGLTQGDYKSPACVKCYFRGHQ-MQ-NGLGGTQLSLVQ-LLN-F-QNDKCFEALMVHVIY-R-LY-QIEWKFV-GVIHHEVYNDRVMYEYSQWHEHTNSAPPNYMCWCVKTGDLPKTPYYKHKNIITQLKFPDFWKDLLVHWSQPMCHYWTE-ISLHCNPHQRRELHQISQDLCWHTQQPPHFCF-WCTKPSSRSVQAAYDEHWVVCHVYWIYNINCRCCIPGHQDCD-LNECCSEFGQSVEEVGTILDNMH-RTDFQRYHIFDHGFYLGFHKMQCVNPL-LHS-MWC-FC-DGQNDKPSMNGKFPKVGETYMNTWNAERHQTDAH-CADPIDRNTRRFSWRCN-LREAFKPNGEMELVVIAKLL-HC--RGESCNDRDMHMSQRHRFHHPLHL-VKET--VT-TEF--H-AHGFD-PGNWPDA-WCTYEMTMEVHINMNAERNKHWDSLSNFRKGI-TPNIKDGKTYFQYQTCYQPHVNLW-GPWAEQTAE-DLHGWTPHGIVKKRAHF-PVKWWHPTPMPTHQGRRFWRPPLLVKMRELASI-IA-T-Y-YIWCWPGCHYRIM-Y-KCAYCFWYEVRFGTQE-KSMRNSLRT-DNF---CYPLALYFQSFWRCYNIWFYKERLYIPVKKTL--QCLVEKKEFVFSIEIRAKIF-SRCWMEFRSKRGSNFKECPTTYIIIWR-KIPHILHAHKRYHEVLLFDDG--VL-MRIQMDHPCGTSVMFHGVNCLQKQMIDIADN-GSFRIAYIC-FWY-A-Y--YKE-HY-SA-FK-REVKNIDYDDCLGTMRYIPCTIGECENFSYGPWK-SAPEMQPVSVRHCQQAVD-DRREQ-T-LEPYRC-SLYINHSKHHHLSPACFDACVASCFCNFAEWMFFRLCVMEMVASRDKDRYE"
[2] "-WR--REH-HH---C-IAFTNPPAVPRDGNTGVLNDCMSQFDTCTEWPRMLGYGMSDNRYNQCQNENHCYFLGSLQYCVMNESAPHDPGMPKDITSQYRWMSKC-SKCPLKWNEP-LFAGMC-Y-RG-V-Q-Y-HSVYTTTALMLTHNALSKHW-TAW-D-KSLEGK-YNPRNSAAHDHNSGQAYWLHEGASNFRPYNKCLRSMHAVKYMLQSKA-MMNGKQPMYILDEPCLYNQQ-LRRKVL-GD-KQYGELVAVHRPSTWCWTTIGLSYCNFTYHLKTHYDQDMQLYSC-YCR-VWR-SDQTYYPLMC---M-LNLPYRMSWDMF---QVNHEHPPVA-FCCILVICTCL-WSNPRPTHNIMWWASF---W-KA--CMQHNNC--FTT--MN-QNVLSVYSAGTKQKGVVQVVLDQQQRHYCRRLHRFMC-A-VWWQ-W-K-ENVVSCIHWR-Y---PFHM-RGPH-HGSMMR-MCYHQYANDECKREGWDRQKRTK-GWPLTSRKPDKIGYTRIW--MF-RAPVTGLC-TSY-HCHRHWPTNKGFHKRH-C-G-FFI-LDHHTSC-KG-KS-WKNINRLVINEE-KLPG-KPW-RYGAN-HGKFGGGMQQNHRQRSINSESAKALCQCLHLAFSCIMYRPQSHGAWYAICCLYCRSKHMSNADCM--TTCDPDFLIESFGTKKEPTHATDCHPKKDIRFGWSNSGWFACYFGVIKDHGNGIFSFFFMMKMNKPNCWHACYRRVSEDQKSYKMIHQSPEE-HMLDKMMPIWLIEG-MAGWYAHSQKNDVETFYKVDGRSRWYSPKMWQ-FCVMFFGYH-CCHWYYKITQRHI-KNFGDSQWMYAKKCIDG-W-SELSYRK-QF-CL-L---QMVMYERKTFFVIHKNYHPCKNQAC-LSCPRQC--L-EMHHKY-QITWLG-WLTWMR--SCRPA-NQEF-IYSKTHYYYFITWPNMNVDSAQCLATSLPGNHVSYATQCFPNKDCDFYDQYRKC---MNRWGGWP--FSWGPCVLLNGNRH-CDKEAHWIVTSVTLVEAIQCFAMMALWGCQPWQTGQGKMKGEELFAHESCCACNEQAAVFYTMIIIHGMGCQDQIKLNPKCSHPAYVEVIYRCHTWWWCL--YPFFHGCREQRLPFNNRKGMPNNQYDSCPTYDMWSPT-------P--LAWISAYFCKFCLDRLHHGIRKCYVSAAMWSEYRLDEHMLTLGGLWTYWFKVDSQMCENDWSPTRIHSVAGRATKERW-RWMKSGNSLQTSEVGYFHEEIKSIEFYFRLIYIRKKWTPMPIYTEYLCHRLALPA-N--F-KSVWHITVFENLPMYRTQPAANSWDAPVRQFMHHTVVRQQILPLSMGEHCTFMNSKYGLM-CAMPMPWVHHHYGYKSKRRLMDKHVKYGKMELLH-E-AFKGQFCIMHTHMRVFEGEAQVRQRPIQWSQYAYFWEIWLEEWK-DCFWV-WK-RW-C-DSHPNSLTIMSYAVYQNMGPDDYSPR-CTHQDTGMPMVVFEIGGSMNRGGAADTDIIVTQEHERY--CIQDPK--G----------A--P-AQ-H-WVWFGLENKCCADDSDEQKLAFMMTKDQMMDWFLIFLGGAVPWHCDYLRHGKVEHIVSDQCGAIKMCPPTTF--WDHEHRWE----NLKNYLHQCGSTQDSWWMWWFLYHKSPFHWKRYKDRDSLVDETKCKKCNLNSVPHAWK-GWDCDD-HVTNYFSENR-YH--QTV--PFIAYDGLAIITCQEIWVWIMKSRFIHWAGH-QGCMNQQFEQFITPMLYWMSMLMRWVSRQMNPIHPWKG-P-M-NYCCCACGILGFEKDLMNRKPSELFRMMLFKLFNIRIWH-------MSAEEWTMQ----LF---AAS---EWAHARMWPRRNCAMPTLQYHRVHNQSHTWAHSSQKQMKKNAFSSGKPKWTNSVKQNIEGAPGNCKWYKPPTHFFGYADVYFQSNWMRYYMCETCMGGSDHVHDTYEHMNFYGCCFAAHGPNFKTYDQSRGRTVLDS-PPW---C------M-------PACVKCDFEDLSFLQQNGLGLTQLSLVAPLLNHFFQNDKG-D-LSAHVLYFEALMVHVIYRFRHDLIHHE----RVMYEYSQWHEHTNSAP-D---R-I----VHQTV--QHMD---Q--F-D-WCALQV--T--LV-FWEEYVPW-CDC-Q---VPTI---V-WHLTHHQNYSFQW--KEFAKFNDKVY---WFM-NNNWM-DI------PNADECHGM-E---D-DKRVHD-ETYYDVLYLESDNAWCH-YQWAV-ISNHDGHPIETFTLNGDV-CSICFTGA-G-PFVQCH---V-EIYR--W-AQVGIGNGRGSTRSMQ-EACQLE-MCRYLNTVYQQM-QMNWWM-GKFMTHNEKRFEGTWEHPFYMHTVSIFDDEDDVKLNDMYHIECVDFWYHYVHAIEYDKDWLGSYWAHYH-TRQ-NMMTQTHEDTNLFTLKLMMTGFCAGHEQQHQLYWELWDC-D--C--WRDHRGDHNCQVDLVCWCTATLCLL-SYFLAVQS-HRTC-PLYRARKFHRFILSYESGGIATVPIRLSWYRFMIIRAEVQQMHMEFDRVPYPG-YGILLCLQEIESMNFSLRAYESVAVDCSHHDL--DDFIEMATIW--EE-IEITVMQGLTYACNICMSDPPYCTHCTQSYFKGESVTTFKTTM-YSYSE-AGTFSMMSPDRCEDDFK-Q-RFCTAGMCHETWHIWSINIIM-FACALQ-LSNGVN-WPQQQSESAAQWEGF-VHNMCDAWLMERYTEYIDLAFIPVHFDPRTPARASMTE-LEWVWIIA-SINNYDPKIYMMFRLPIEQIKPQVIM-CAHTSSLSMSHDVSFMEERWCWDMY--HYKKVGMT-LCWPV-VDDSAAD-P-WIT-HE-EMTMIETDAQQTFM"
q()
